import{s as ie,v as L,r as Z,g as k,c as F,h as R,i as U,A as H,d as P,k as D,D as J,E as ue,B as ce,F as fe,l as de,m as me,C as K,e as W}from"../chunks/scheduler.635b56cd.js";import{S as he,i as _e,d as T,p as X,v as pe,j as ge,e as E,k as be,g as v,a as q,n as y,m as ve,q as Q,b as we,t as ye,l as ke,s as Re}from"../chunks/index.1e81eea3.js";import{g as De}from"../chunks/globals.7f7f1b26.js";import{N as re}from"../chunks/Navigation.acb20dfd.js";import{c as $,d as V,e as x,a as Y,u as A,f as ee,g as te,q as ne,b as O,w as se}from"../chunks/firebase.a6fa023d.js";import{I as Ce}from"../chunks/Icon.20649865.js";const{console:Ee}=De,C="src/routes/(protected)/friends/+page.svelte";function oe(l,e,s){const n=l.slice();return n[12]=e[s],n[14]=s,n}function M(l){let e,s;function n(a,t){return t&10&&(e=null),e==null&&(e=!!a[3].following.includes(a[12].userId)),e?ae:le}let f=n(l,-1),m=f(l);const i={c:function(){m.c(),s=W()},l:function(t){m.l(t),s=W()},m:function(t,d){m.m(t,d),q(t,s,d)},p:function(t,d){f===(f=n(t,d))&&m?m.p(t,d):(m.d(1),m=f(t),m&&(m.c(),m.m(s.parentNode,s)))},d:function(t){t&&E(s),m.d(t)}};return T("SvelteRegisterBlock",{block:i,id:M.name,type:"if",source:"(142:4) {#if $user.uid !== result.userId}",ctx:l}),i}function le(l){let e,s="Follow",n,f;function m(){return l[9](l[12])}const i={c:function(){e=k("button"),e.textContent=s,this.h()},l:function(t){e=R(t,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-xl7pdg"&&(e.textContent=s),this.h()},h:function(){v(e,"class","bg-blue-400 w-full text-white font-semibold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-opacity-50 transition duration-300 ease-in-out border-b-4 border-blue-500"),D(e,C,152,6,4706)},m:function(t,d){q(t,e,d),n||(f=Q(e,"click",m,!1,!1,!1,!1),n=!0)},p:function(t,d){l=t},d:function(t){t&&E(e),n=!1,f()}};return T("SvelteRegisterBlock",{block:i,id:le.name,type:"else",source:"(152:5) {:else}",ctx:l}),i}function ae(l){let e,s="Unfollow",n,f;function m(){return l[8](l[12])}const i={c:function(){e=k("button"),e.textContent=s,this.h()},l:function(t){e=R(t,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-fvil23"&&(e.textContent=s),this.h()},h:function(){v(e,"class","bg-red-400 w-full text-white font-semibold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-red-300 focus:ring-opacity-50 transition duration-300 ease-in-out border-b-4 border-red-500"),D(e,C,143,6,4343)},m:function(t,d){q(t,e,d),n||(f=Q(e,"click",m,!1,!1,!1,!1),n=!0)},p:function(t,d){l=t},d:function(t){t&&E(e),n=!1,f()}};return T("SvelteRegisterBlock",{block:i,id:ae.name,type:"if",source:"(143:5) {#if $userData.following.includes(result.userId)}",ctx:l}),i}function z(l){let e,s,n,f,m,i,a=l[12].username+"",t,d,w,I,u=l[2].uid!==l[12].userId&&M(l);const S={c:function(){e=k("div"),s=k("div"),n=k("img"),m=F(),i=k("p"),t=de(a),d=F(),w=k("div"),u&&u.c(),I=F(),this.h()},l:function(g){e=R(g,"DIV",{class:!0});var b=U(e);s=R(b,"DIV",{class:!0});var c=U(s);n=R(c,"IMG",{src:!0,class:!0,alt:!0}),m=P(c),i=R(c,"P",{class:!0});var r=U(i);t=me(r,a),r.forEach(E),c.forEach(E),d=P(b),w=R(b,"DIV",{class:!0});var _=U(w);u&&u.l(_),_.forEach(E),I=P(b),b.forEach(E),this.h()},h:function(){var g;K(n.src,f=(g=l[12])==null?void 0:g.avatar)||v(n,"src",f),v(n,"class","rounded-full h-12"),v(n,"alt",""),D(n,C,137,4,4080),v(i,"class","font-semibold"),D(i,C,138,4,4146),v(s,"class","flex items-center gap-3"),D(s,C,136,3,4038),v(w,"class","flex items-center gap-3"),D(w,C,140,3,4206),v(e,"class","flex mt-5 px-5 py-2 justify-between items-center w-full min-h-[3em] border-2 border-gray-700 rounded mb-2 overflow-hidden"),D(e,C,133,2,3893)},m:function(g,b){q(g,e,b),y(e,s),y(s,n),y(s,m),y(s,i),y(i,t),y(e,d),y(e,w),u&&u.m(w,null),y(e,I)},p:function(g,b){var c;b&2&&!K(n.src,f=(c=g[12])==null?void 0:c.avatar)&&v(n,"src",f),b&2&&a!==(a=g[12].username+"")&&Re(t,a),g[2].uid!==g[12].userId?u?u.p(g,b):(u=M(g),u.c(),u.m(w,null)):u&&(u.d(1),u=null)},d:function(g){g&&E(e),u&&u.d()}};return T("SvelteRegisterBlock",{block:S,id:z.name,type:"each",source:"(133:1) {#each searchResults as result, i}",ctx:l}),S}function G(l){let e,s,n,f="Friends",m,i,a,t,d,w,I,u,S,N,g,b=X(l[1]),c=[];for(let _=0;_<b.length;_+=1)c[_]=z(oe(l,b,_));u=new re({$$inline:!0});const r={c:function(){e=k("div"),s=k("nav"),n=k("h2"),n.textContent=f,m=F(),i=k("input"),a=F(),t=k("form"),d=k("input"),w=F();for(let o=0;o<c.length;o+=1)c[o].c();I=F(),ge(u.$$.fragment),this.h()},l:function(o){e=R(o,"DIV",{class:!0});var h=U(e);s=R(h,"NAV",{class:!0});var p=U(s);n=R(p,"H2",{class:!0,"data-svelte-h":!0}),H(n)!=="svelte-1x5kyhf"&&(n.textContent=f),p.forEach(E),m=P(h),i=R(h,"INPUT",{class:!0,placeholder:!0,type:!0}),a=P(h),t=R(h,"FORM",{});var j=U(t);d=R(j,"INPUT",{type:!0,class:!0}),j.forEach(E),w=P(h);for(let B=0;B<c.length;B+=1)c[B].l(h);h.forEach(E),I=P(o),be(u.$$.fragment,o),this.h()},h:function(){v(n,"class","font-bold text-xl capitalize"),D(n,C,115,2,3290),v(s,"class","flex justify-between mb-5"),D(s,C,114,1,3248),v(i,"class","w-full rounded p-2 mt-10 mb-2 bg-gray-700 border-2 border-gray-600 text-white"),v(i,"placeholder","Search for a user"),v(i,"type","text"),D(i,C,118,1,3354),v(d,"type","submit"),d.value="Zoeken",v(d,"class","bg-blue-400 w-full text-white font-semibold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-opacity-50 transition duration-300 ease-in-out border-b-4 border-blue-500"),D(d,C,125,2,3575),D(t,C,124,1,3529),v(e,"class","p-5 mb-20"),D(e,C,113,0,3223)},m:function(o,h){q(o,e,h),y(e,s),y(s,n),y(e,m),y(e,i),J(i,l[0]),y(e,a),y(e,t),y(t,d),y(e,w);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(e,null);q(o,I,h),ve(u,o,h),S=!0,N||(g=[Q(i,"input",l[7]),Q(t,"submit",ue(l[4]),!1,!0,!1,!1)],N=!0)},p:function(o,[h]){if(h&1&&i.value!==o[0]&&J(i,o[0]),h&110){b=X(o[1]);let p;for(p=0;p<b.length;p+=1){const j=oe(o,b,p);c[p]?c[p].p(j,h):(c[p]=z(j),c[p].c(),c[p].m(e,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=b.length}},i:function(o){S||(we(u.$$.fragment,o),S=!0)},o:function(o){ye(u.$$.fragment,o),S=!1},d:function(o){o&&(E(e),E(I)),ce(c,o),ke(u,o),N=!1,fe(g)}};return T("SvelteRegisterBlock",{block:r,id:G.name,type:"component",source:"",ctx:l}),r}function Ie(l,e,s){let n,f;L(Y,"user"),Z(l,Y,r=>s(2,n=r)),L(A,"userData"),Z(l,A,r=>s(3,f=r));let{$$slots:m={},$$scope:i}=e;pe("Page",m,[]);let a="",t=[];const d=$(x,"users"),w=V(x,"users",n.uid),I=async()=>{try{const r=ne(d,se("username","==",a.toLowerCase())),_=await te(r);if(_.empty){s(1,t=[]),alert("No user found");return}else s(1,t=[]),_.forEach(o=>{const h=o.data();t.push({userId:o.id,username:h.username,avatar:h.avatar})})}catch(r){console.error("Error searching for users:",r),s(1,t=[])}},u=async r=>{const _=V(x,"users",r);try{if(n.uid===r){alert("You cannot follow yourself.");return}const o=f.following||[];if(o.includes(r))alert("You are already following this user.");else{o.push(r),await O(w,{following:o});const h=f.followers||[];h.push(n.uid),await O(_,{followers:h})}}catch(o){console.error("Error adding user to following:",o)}},S=async r=>{const _=V(x,"users",r);await ee(_);try{if(n.uid===r){alert("You cannot unfollow yourself.");return}const o=f.following||[];if(o.includes(r)){const h=o.filter(B=>B!==r);await O(w,{following:h});const j=(f.followers||[]).filter(B=>B!==n.uid);await O(_,{followers:j})}}catch(o){console.error("Error removing user from following:",o)}},N=[];Object.keys(e).forEach(r=>{!~N.indexOf(r)&&r.slice(0,2)!=="$$"&&r!=="slot"&&Ee.warn(`<Page> was created with unknown prop '${r}'`)});function g(){a=this.value,s(0,a)}const b=r=>{S(r.userId)},c=r=>{u(r.userId)};return l.$capture_state=()=>({Navigation:re,db:x,user:Y,userData:A,Icon:Ce,collection:$,doc:V,getDoc:ee,getDocs:te,query:ne,updateDoc:O,where:se,searchQuery:a,searchResults:t,userRef:d,currentUserRef:w,getSearch:I,addFriend:u,removeFriend:S,$user:n,$userData:f}),l.$inject_state=r=>{"searchQuery"in r&&s(0,a=r.searchQuery),"searchResults"in r&&s(1,t=r.searchResults)},e&&"$$inject"in e&&l.$inject_state(e.$$inject),[a,t,n,f,I,u,S,g,b,c]}class Pe extends he{constructor(e){super(e),_e(this,e,Ie,G,ie,{}),T("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:G.name})}}export{Pe as component};
