import{s as Le,e as fe,w as X,g as _,c as B,h as g,i as k,d as C,k as v,l as ce,m as ue,B as ct,C as Ce,v as ye,r as ke,o as Ae,A as Ye,D as Ne,E as ut,F as ft,x as Ze}from"../chunks/scheduler.635b56cd.js";import{h as qe,T as be,u as dt}from"../chunks/TrackSearchResult.6780c042.js";import{S as Je,i as Ke,d as G,v as Xe,a as W,e as h,p as ze,g as m,n as d,s as he,b as N,t as z,h as _e,c as ge,q as Se,j as se,k as ne,m as re,l as ie,r as ve}from"../chunks/index.1e81eea3.js";import{A as Be}from"../chunks/ArtistSearchResult.2aadac5b.js";import{a as pe,r as Oe,c as te}from"../chunks/utils.808755f5.js";import{s as me}from"../chunks/index.5a91c927.js";import{c as we,d as Me,b as Fe,q as Qe,w as We,g as Ge,e as Ee,u as Re,a as Ie}from"../chunks/firebase.a6fa023d.js";import{I as xe}from"../chunks/Icon.20649865.js";import{N as et}from"../chunks/Navigation.acb20dfd.js";import{s as De}from"../chunks/spotifyStore.cc39e0ec.js";const P="src/lib/components/PlaylistResult.svelte";function He(a,e,t){const l=a.slice();return l[2]=e[t],l}function tt(a){let e,t,l,s,o,r,c,n,i,u,f,b,O,T,E,A,$,U,F,p,V,w,M,j,q,H,L,Q;const S={c:function(){e=_("div"),t=_("div"),l=B(),s=_("div"),o=_("div"),r=_("div"),c=B(),n=_("div"),i=_("div"),u=B(),f=_("div"),b=_("div"),O=B(),T=_("div"),E=_("div"),A=B(),$=_("div"),U=_("div"),F=_("div"),p=B(),V=_("div"),w=_("div"),M=B(),j=_("div"),q=_("div"),H=B(),L=_("div"),Q=_("div"),this.h()},l:function(D){e=g(D,"DIV",{class:!0});var J=k(e);t=g(J,"DIV",{class:!0}),k(t).forEach(h),l=C(J),s=g(J,"DIV",{class:!0});var oe=k(s);o=g(oe,"DIV",{class:!0});var ae=k(o);r=g(ae,"DIV",{class:!0}),k(r).forEach(h),c=C(ae),n=g(ae,"DIV",{class:!0});var x=k(n);i=g(x,"DIV",{class:!0}),k(i).forEach(h),x.forEach(h),ae.forEach(h),u=C(oe),f=g(oe,"DIV",{class:!0});var y=k(f);b=g(y,"DIV",{class:!0}),k(b).forEach(h),O=C(y),T=g(y,"DIV",{class:!0});var R=k(T);E=g(R,"DIV",{class:!0}),k(E).forEach(h),R.forEach(h),y.forEach(h),oe.forEach(h),A=C(J),$=g(J,"DIV",{class:!0});var Z=k($);U=g(Z,"DIV",{class:!0});var K=k(U);F=g(K,"DIV",{class:!0}),k(F).forEach(h),p=C(K),V=g(K,"DIV",{class:!0});var ee=k(V);w=g(ee,"DIV",{class:!0}),k(w).forEach(h),ee.forEach(h),K.forEach(h),M=C(Z),j=g(Z,"DIV",{class:!0});var le=k(j);q=g(le,"DIV",{class:!0}),k(q).forEach(h),H=C(le),L=g(le,"DIV",{class:!0});var de=k(L);Q=g(de,"DIV",{class:!0}),k(Q).forEach(h),de.forEach(h),le.forEach(h),Z.forEach(h),J.forEach(h),this.h()},h:function(){m(t,"class","w-1/2 h-6 bg-dark-gray border-2 border-b-4 border-gray-700 rounded-md mb-2"),v(t,P,26,2,829),m(r,"class","h-12 w-12 bg-gray-500"),v(r,P,29,4,1052),m(i,"class","w-1/2 h-4 bg-gray-500 rounded-full"),v(i,P,31,5,1140),m(n,"class","flex items-center truncate"),v(n,P,30,4,1094),m(o,"class","w-full bg-dark-gray border-2 border-b-4 border-gray-700 rounded-md flex"),v(o,P,28,3,962),m(b,"class","h-12 w-12 bg-gray-500"),v(b,P,35,4,1305),m(E,"class","w-1/2 h-4 bg-gray-500 rounded-full"),v(E,P,37,5,1393),m(T,"class","flex items-center truncate"),v(T,P,36,4,1347),m(f,"class","w-full bg-dark-gray border-2 border-b-4 border-gray-700 rounded-md flex"),v(f,P,34,3,1215),m(s,"class","grid grid-cols-2 gap-2"),v(s,P,27,2,922),m(F,"class","h-12 w-12 bg-gray-500"),v(F,P,43,4,1611),m(w,"class","w-1/2 h-4 bg-gray-500 rounded-full"),v(w,P,45,5,1699),m(V,"class","flex items-center truncate"),v(V,P,44,4,1653),m(U,"class","w-full bg-dark-gray border-2 border-b-4 border-gray-700 rounded-md flex"),v(U,P,42,3,1521),m(q,"class","h-12 w-12 bg-gray-500"),v(q,P,49,4,1864),m(Q,"class","w-1/2 h-4 bg-gray-500 rounded-full"),v(Q,P,51,5,1952),m(L,"class","flex items-center truncate"),v(L,P,50,4,1906),m(j,"class","w-full bg-dark-gray border-2 border-b-4 border-gray-700 rounded-md flex"),v(j,P,48,3,1774),m($,"class","grid grid-cols-2 gap-2 mt-2"),v($,P,41,2,1476),m(e,"class","my-2 mt-10 font-bold text-2xl animate-pulse"),v(e,P,25,1,769)},m:function(D,J){W(D,e,J),d(e,t),d(e,l),d(e,s),d(s,o),d(o,r),d(o,c),d(o,n),d(n,i),d(s,u),d(s,f),d(f,b),d(f,O),d(f,T),d(T,E),d(e,A),d(e,$),d($,U),d(U,F),d(U,p),d(U,V),d(V,w),d($,M),d($,j),d(j,q),d(j,H),d(j,L),d(L,Q)},p:X,d:function(D){D&&h(e)}};return G("SvelteRegisterBlock",{block:S,id:tt.name,type:"else",source:"(24:0) {:else}",ctx:a}),S}function st(a){let e,t,l,s,o=ze(a[0].items),r=[];for(let n=0;n<o.length;n+=1)r[n]=Pe(He(a,o,n));const c={c:function(){e=_("h2"),t=ce(a[1]),l=B(),s=_("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l:function(i){e=g(i,"H2",{class:!0});var u=k(e);t=ue(u,a[1]),u.forEach(h),l=C(i),s=g(i,"DIV",{class:!0});var f=k(s);for(let b=0;b<r.length;b+=1)r[b].l(f);f.forEach(h),this.h()},h:function(){m(e,"class","my-2 mt-10 font-bold text-2xl"),v(e,P,6,1,82),m(s,"class","grid grid-cols-2 gap-2"),v(s,P,8,1,139)},m:function(i,u){W(i,e,u),d(e,t),W(i,l,u),W(i,s,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(s,null)},p:function(i,u){if(u&2&&he(t,i[1]),u&1){o=ze(i[0].items);let f;for(f=0;f<o.length;f+=1){const b=He(i,o,f);r[f]?r[f].p(b,u):(r[f]=Pe(b),r[f].c(),r[f].m(s,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=o.length}},d:function(i){i&&(h(e),h(l),h(s)),ct(r,i)}};return G("SvelteRegisterBlock",{block:c,id:st.name,type:"if",source:"(6:0) {#if results}",ctx:a}),c}function Pe(a){let e,t,l,s,o,r,c,n,i=a[2].name+"",u,f,b;const O={c:function(){e=_("a"),t=_("div"),l=_("img"),r=B(),c=_("div"),n=_("p"),u=ce(i),f=B(),this.h()},l:function(E){e=g(E,"A",{href:!0});var A=k(e);t=g(A,"DIV",{class:!0});var $=k(t);l=g($,"IMG",{class:!0,src:!0,alt:!0}),r=C($),c=g($,"DIV",{class:!0});var U=k(c);n=g(U,"P",{class:!0});var F=k(n);u=ue(F,i),F.forEach(h),U.forEach(h),$.forEach(h),f=C(A),A.forEach(h),this.h()},h:function(){m(l,"class","h-12 w-12 object-cover"),Ce(l.src,s=a[2].images[0].url)||m(l,"src",s),m(l,"alt",o=a[2].name),v(l,P,13,5,411),m(n,"class","text-white text-md font-semibold truncate pl-2"),v(n,P,15,6,551),m(c,"class","flex items-center truncate"),v(c,P,14,5,504),m(t,"class","w-full bg-dark-gray border-2 border-b-4 border-gray-700 rounded-md flex"),v(t,P,12,4,320),m(e,"href",b=`/playlist/${a[2].id}`),v(e,P,10,3,215)},m:function(E,A){W(E,e,A),d(e,t),d(t,l),d(t,r),d(t,c),d(c,n),d(n,u),d(e,f)},p:function(E,A){A&1&&!Ce(l.src,s=E[2].images[0].url)&&m(l,"src",s),A&1&&o!==(o=E[2].name)&&m(l,"alt",o),A&1&&i!==(i=E[2].name+"")&&he(u,i),A&1&&b!==(b=`/playlist/${E[2].id}`)&&m(e,"href",b)},d:function(E){E&&h(e)}};return G("SvelteRegisterBlock",{block:O,id:Pe.name,type:"each",source:"(10:2) {#each results.items as playlist}",ctx:a}),O}function $e(a){let e;function t(r,c){return r[0]?st:tt}let l=t(a),s=l(a);const o={c:function(){s.c(),e=fe()},l:function(c){s.l(c),e=fe()},m:function(c,n){s.m(c,n),W(c,e,n)},p:function(c,[n]){l===(l=t(c))&&s?s.p(c,n):(s.d(1),s=l(c),s&&(s.c(),s.m(e.parentNode,e)))},i:X,o:X,d:function(c){c&&h(e),s.d(c)}};return G("SvelteRegisterBlock",{block:o,id:$e.name,type:"component",source:"",ctx:a}),o}function ht(a,e,t){let{$$slots:l={},$$scope:s}=e;Xe("PlaylistResult",l,[]);let{results:o=null}=e,{title:r}=e;a.$$.on_mount.push(function(){r===void 0&&!("title"in e||a.$$.bound[a.$$.props.title])&&console.warn("<PlaylistResult> was created without expected prop 'title'")});const c=["results","title"];return Object.keys(e).forEach(n=>{!~c.indexOf(n)&&n.slice(0,2)!=="$$"&&n!=="slot"&&console.warn(`<PlaylistResult> was created with unknown prop '${n}'`)}),a.$$set=n=>{"results"in n&&t(0,o=n.results),"title"in n&&t(1,r=n.title)},a.$capture_state=()=>({results:o,title:r}),a.$inject_state=n=>{"results"in n&&t(0,o=n.results),"title"in n&&t(1,r=n.title)},e&&"$$inject"in e&&a.$inject_state(e.$$inject),[o,r]}class nt extends Je{constructor(e){super(e),Ke(this,e,ht,$e,Le,{results:0,title:1}),G("SvelteRegisterComponent",{component:this,tagName:"PlaylistResult",options:e,id:$e.name})}get results(){throw new Error("<PlaylistResult>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set results(e){throw new Error("<PlaylistResult>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get title(){throw new Error("<PlaylistResult>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(e){throw new Error("<PlaylistResult>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Y="src/routes/(protected)/+page.svelte";function rt(a){let e,t,l=a[15].message+"",s;const o={c:function(){e=_("p"),t=ce("Error: "),s=ce(l),this.h()},l:function(c){e=g(c,"P",{});var n=k(e);t=ue(n,"Error: "),s=ue(n,l),n.forEach(h),this.h()},h:function(){v(e,Y,243,1,8532)},m:function(c,n){W(c,e,n),d(e,t),d(e,s)},p:function(c,n){n&64&&l!==(l=c[15].message+"")&&he(s,l)},i:X,o:X,d:function(c){c&&h(e)}};return G("SvelteRegisterBlock",{block:o,id:rt.name,type:"catch",source:"(243:0) {:catch error}",ctx:a}),o}function it(a){let e,t,l,s;const o=[at,ot],r=[];function c(i,u){return i[14]?0:1}e=c(a),t=r[e]=o[e](a);const n={c:function(){t.c(),l=fe()},l:function(u){t.l(u),l=fe()},m:function(u,f){r[e].m(u,f),W(u,l,f),s=!0},p:function(u,f){let b=e;e=c(u),e===b?r[e].p(u,f):(_e(),z(r[b],1,1,()=>{r[b]=null}),ge(),t=r[e],t?t.p(u,f):(t=r[e]=o[e](u),t.c()),N(t,1),t.m(l.parentNode,l))},i:function(u){s||(N(t),s=!0)},o:function(u){z(t),s=!1},d:function(u){u&&h(l),r[e].d(u)}};return G("SvelteRegisterBlock",{block:n,id:it.name,type:"then",source:"(192:0) {:then token}",ctx:a}),n}function ot(a){let e,t="Authorize with Spotify",l,s;const o={c:function(){e=_("button"),e.textContent=t,this.h()},l:function(c){e=g(c,"BUTTON",{"data-svelte-h":!0}),Ye(e)!=="svelte-126e2f0"&&(e.textContent=t),this.h()},h:function(){v(e,Y,240,2,8441)},m:function(c,n){W(c,e,n),l||(s=Se(e,"click",a[8],!1,!1,!1,!1),l=!0)},p:X,i:X,o:X,d:function(c){c&&h(e),l=!1,s()}};return G("SvelteRegisterBlock",{block:o,id:ot.name,type:"else",source:"(240:1) {:else}",ctx:a}),o}function at(a){var oe,ae;let e,t,l,s,o=((oe=a[7])==null?void 0:oe.username)+"",r,c,n,i,u,f,b=(((ae=a[7])==null?void 0:ae.score)||0)+"",O,T,E,A,$,U,F,p,V,w,M,j,q,H,L,Q;i=new xe({props:{icon:"fluent-emoji:gem-stone",class:"text-blue-400",height:"32"},$$inline:!0});let S=a[5]&&a[5].length>0&&Ve(a);V=new nt({props:{results:a[4],title:"Your Playlists"},$$inline:!0});let I=!a[1]&&Te(a),D=a[1]&&Ue(a);q=new et({$$inline:!0});const J={c:function(){e=_("div"),t=_("nav"),l=_("h2"),s=ce("Welcome, "),r=ce(o),c=B(),n=_("span"),se(i.$$.fragment),u=B(),f=_("p"),O=ce(b),T=B(),E=_("input"),A=B(),$=_("form"),U=_("input"),F=B(),S&&S.c(),p=B(),se(V.$$.fragment),w=B(),I&&I.c(),M=B(),D&&D.c(),j=B(),se(q.$$.fragment),this.h()},l:function(y){e=g(y,"DIV",{class:!0});var R=k(e);t=g(R,"NAV",{class:!0});var Z=k(t);l=g(Z,"H2",{class:!0});var K=k(l);s=ue(K,"Welcome, "),r=ue(K,o),K.forEach(h),c=C(Z),n=g(Z,"SPAN",{class:!0});var ee=k(n);ne(i.$$.fragment,ee),u=C(ee),f=g(ee,"P",{class:!0});var le=k(f);O=ue(le,b),le.forEach(h),ee.forEach(h),Z.forEach(h),T=C(R),E=g(R,"INPUT",{class:!0,placeholder:!0,type:!0}),A=C(R),$=g(R,"FORM",{});var de=k($);U=g(de,"INPUT",{type:!0,class:!0}),de.forEach(h),F=C(R),S&&S.l(R),p=C(R),ne(V.$$.fragment,R),w=C(R),I&&I.l(R),M=C(R),D&&D.l(R),R.forEach(h),j=C(y),ne(q.$$.fragment,y),this.h()},h:function(){m(l,"class","font-bold text-xl capitalize"),v(l,Y,196,4,6533),m(f,"class","font-black tracking-wide text-3xl text-blue-300"),v(f,Y,199,5,6736),m(n,"class","flex items-center gap-2"),v(n,Y,197,4,6614),m(t,"class","flex justify-between"),v(t,Y,195,3,6494),m(E,"class","w-full rounded p-2 mt-10 mb-2 bg-gray-700 border-2 border-gray-600 text-white"),m(E,"placeholder","Search for a track..."),m(E,"type","text"),v(E,Y,202,3,6848),m(U,"type","submit"),U.value="Zoeken",m(U,"class","bg-blue-400 w-full text-white font-semibold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-opacity-50 transition duration-300 ease-in-out border-b-4 border-blue-500"),v(U,Y,209,4,7087),v($,Y,208,3,7039),m(e,"class","p-5 mb-16"),v(e,Y,193,2,6403)},m:function(y,R){W(y,e,R),d(e,t),d(t,l),d(l,s),d(l,r),d(t,c),d(t,n),re(i,n,null),d(n,u),d(n,f),d(f,O),d(e,T),d(e,E),Ne(E,a[0]),d(e,A),d(e,$),d($,U),d(e,F),S&&S.m(e,null),d(e,p),re(V,e,null),d(e,w),I&&I.m(e,null),d(e,M),D&&D.m(e,null),W(y,j,R),re(q,y,R),H=!0,L||(Q=[Se(E,"input",a[10]),Se($,"submit",ut(a[9]),!1,!0,!1,!1)],L=!0)},p:function(y,R){var K,ee;(!H||R&128)&&o!==(o=((K=y[7])==null?void 0:K.username)+"")&&he(r,o),(!H||R&128)&&b!==(b=(((ee=y[7])==null?void 0:ee.score)||0)+"")&&he(O,b),R&1&&E.value!==y[0]&&Ne(E,y[0]),y[5]&&y[5].length>0?S?(S.p(y,R),R&32&&N(S,1)):(S=Ve(y),S.c(),N(S,1),S.m(e,p)):S&&(_e(),z(S,1,1,()=>{S=null}),ge());const Z={};R&16&&(Z.results=y[4]),V.$set(Z),y[1]?I&&(_e(),z(I,1,1,()=>{I=null}),ge()):I?(I.p(y,R),R&2&&N(I,1)):(I=Te(y),I.c(),N(I,1),I.m(e,M)),y[1]?D?(D.p(y,R),R&2&&N(D,1)):(D=Ue(y),D.c(),N(D,1),D.m(e,null)):D&&(_e(),z(D,1,1,()=>{D=null}),ge())},i:function(y){H||(N(i.$$.fragment,y),N(S),N(V.$$.fragment,y),N(I),N(D),N(q.$$.fragment,y),H=!0)},o:function(y){z(i.$$.fragment,y),z(S),z(V.$$.fragment,y),z(I),z(D),z(q.$$.fragment,y),H=!1},d:function(y){y&&(h(e),h(j)),ie(i),S&&S.d(),ie(V),I&&I.d(),D&&D.d(),ie(q,y),L=!1,ft(Q)}};return G("SvelteRegisterBlock",{block:J,id:at.name,type:"if",source:"(193:1) {#if token}",ctx:a}),J}function Ve(a){let e,t;e=new be({props:{results:a[5],title:"Get 3 stars!"},$$inline:!0});const l={c:function(){se(e.$$.fragment)},l:function(o){ne(e.$$.fragment,o)},m:function(o,r){re(e,o,r),t=!0},p:function(o,r){const c={};r&32&&(c.results=o[5]),e.$set(c)},i:function(o){t||(N(e.$$.fragment,o),t=!0)},o:function(o){z(e.$$.fragment,o),t=!1},d:function(o){ie(e,o)}};return G("SvelteRegisterBlock",{block:l,id:Ve.name,type:"if",source:"(217:3) {#if unfinishedTracks && unfinishedTracks.length > 0}",ctx:a}),l}function Te(a){let e,t,l,s,o,r;t=new Be({props:{results:a[2],title:"Favorite Artists"},$$inline:!0}),s=new be({props:{results:a[3],title:"Favorite Tracks"},$$inline:!0});const c={c:function(){e=_("div"),se(t.$$.fragment),l=B(),se(s.$$.fragment),this.h()},l:function(i){e=g(i,"DIV",{});var u=k(e);ne(t.$$.fragment,u),l=C(u),ne(s.$$.fragment,u),u.forEach(h),this.h()},h:function(){v(e,Y,223,4,7749)},m:function(i,u){W(i,e,u),re(t,e,null),d(e,l),re(s,e,null),r=!0},p:function(i,u){const f={};u&4&&(f.results=i[2]),t.$set(f);const b={};u&8&&(b.results=i[3]),s.$set(b)},i:function(i){r||(N(t.$$.fragment,i),N(s.$$.fragment,i),i&&Ze(()=>{r&&(o||(o=ve(e,me,{},!0)),o.run(1))}),r=!0)},o:function(i){z(t.$$.fragment,i),z(s.$$.fragment,i),i&&(o||(o=ve(e,me,{},!1)),o.run(0)),r=!1},d:function(i){i&&h(e),ie(t),ie(s),i&&o&&o.end()}};return G("SvelteRegisterBlock",{block:c,id:Te.name,type:"if",source:"(223:3) {#if !searchResults}",ctx:a}),c}function Ue(a){let e,t,l,s,o,r;t=new Be({props:{results:a[1].artists.items,title:"Artists"},$$inline:!0}),s=new be({props:{results:a[1].tracks.items,title:"Tracks"},$$inline:!0});const c={c:function(){e=_("div"),se(t.$$.fragment),l=B(),se(s.$$.fragment),this.h()},l:function(i){e=g(i,"DIV",{});var u=k(e);ne(t.$$.fragment,u),l=C(u),ne(s.$$.fragment,u),u.forEach(h),this.h()},h:function(){v(e,Y,229,4,7972)},m:function(i,u){W(i,e,u),re(t,e,null),d(e,l),re(s,e,null),r=!0},p:function(i,u){const f={};u&2&&(f.results=i[1].artists.items),t.$set(f);const b={};u&2&&(b.results=i[1].tracks.items),s.$set(b)},i:function(i){r||(N(t.$$.fragment,i),N(s.$$.fragment,i),i&&Ze(()=>{r&&(o||(o=ve(e,me,{},!0)),o.run(1))}),r=!0)},o:function(i){z(t.$$.fragment,i),z(s.$$.fragment,i),i&&(o||(o=ve(e,me,{},!1)),o.run(0)),r=!1},d:function(i){i&&h(e),ie(t),ie(s),i&&o&&o.end()}};return G("SvelteRegisterBlock",{block:c,id:Ue.name,type:"if",source:"(229:3) {#if searchResults}",ctx:a}),c}function lt(a){let e,t="Authorizing...";const l={c:function(){e=_("p"),e.textContent=t,this.h()},l:function(o){e=g(o,"P",{"data-svelte-h":!0}),Ye(e)!=="svelte-wx5pme"&&(e.textContent=t),this.h()},h:function(){v(e,Y,190,1,6352)},m:function(o,r){W(o,e,r)},p:X,i:X,o:X,d:function(o){o&&h(e)}};return G("SvelteRegisterBlock",{block:l,id:lt.name,type:"pending",source:"(190:21)   <p>Authorizing...</p> {:then token}",ctx:a}),l}function je(a){let e,t,l,s={ctx:a,current:null,token:null,hasCatch:!0,pending:lt,then:it,catch:rt,value:14,error:15,blocks:[,,,]};qe(t=a[6],s);const o={c:function(){e=fe(),s.block.c()},l:function(c){e=fe(),s.block.l(c)},m:function(c,n){W(c,e,n),s.block.m(c,s.anchor=n),s.mount=()=>e.parentNode,s.anchor=e,l=!0},p:function(c,[n]){a=c,s.ctx=a,n&64&&t!==(t=a[6])&&qe(t,s)||dt(s,a,n)},i:function(c){l||(N(s.block),l=!0)},o:function(c){for(let n=0;n<3;n+=1){const i=s.blocks[n];z(i)}l=!1},d:function(c){c&&h(e),s.block.d(c),s.token=null,s=null}};return G("SvelteRegisterBlock",{block:o,id:je.name,type:"component",source:"",ctx:a}),o}function mt(a,e,t){let l,s,o;ye(Ie,"fbUser"),ke(a,Ie,p=>t(12,l=p)),ye(pe,"accessToken"),ke(a,pe,p=>t(6,s=p)),ye(Re,"userData"),ke(a,Re,p=>t(7,o=p));let{$$slots:r={},$$scope:c}=e;Xe("Page",r,[]);let n="",i=null,u=[],f=[],b={},O,T=[];const E=()=>{const V="https://accounts.spotify.com/authorize?client_id=ae8a8377a94d42d7b7e69086cde1bf6d&response_type=code&redirect_uri=https://translatetunes.web.app&scope=user-read-private user-read-email user-top-read";typeof window<"u"&&(window.location.href=V)};Ae(async()=>{const p=we(Ee,"users"),V=Me(p,l.uid);if(typeof window<"u"&&window.location.search.includes("code")){const M=new URLSearchParams(window.location.search).get("code");if(M&&!window.localStorage.getItem("refresh_token")){const j=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${btoa("ae8a8377a94d42d7b7e69086cde1bf6d:6901ef8b39ce4d1497749180106c32b5")}`},body:`grant_type=authorization_code&code=${M}&redirect_uri=https://translatetunes.web.app`});if(j.ok){const q=await j.json();pe.set(q.access_token),Oe.set(q.refresh_token)}}}await te("https://api.spotify.com/v1/me/top/artists").then(w=>t(2,u=w.items)),await te("https://api.spotify.com/v1/me/top/tracks").then(w=>t(3,f=w.items)),await te("https://api.spotify.com/v1/me/").then(w=>(b=w,De.set(w))),await te("https://api.spotify.com/v1/me/").then(w=>{var M;b=w,De.set(w),Fe(V,{avatar:(M=w==null?void 0:w.images[0])==null?void 0:M.url})}),await te("https://api.spotify.com/v1/me/playlists?limit=5").then(w=>t(4,O=w)),$()});const A=async()=>{const p=encodeURIComponent(n),V=encodeURIComponent("album,artist,playlist,track"),w=await te(`https://api.spotify.com/v1/search?q=${p}&type=${V}`);t(1,i={artists:w.artists,tracks:w.tracks,albums:w.albums,playlists:w.playlists})},$=async()=>{const p=l.uid,V=we(Ee,"playedSongs"),w=Qe(V,We("userId","==",p)),M=["easy","medium","hard"],j=new Map;(await Ge(w)).forEach(Q=>{const S=Q.data(),I=S.trackId,D=S.difficulty;j.has(I)||j.set(I,[]),j.get(I).push(D)});const H=[];j.forEach((Q,S)=>{M.filter(D=>!Q.includes(D)).length>0&&H.push(S)});const L=H.join(",");await te(`https://api.spotify.com/v1/tracks?ids=${L}`).then(Q=>{t(5,T=Q.tracks)})},U=[];Object.keys(e).forEach(p=>{!~U.indexOf(p)&&p.slice(0,2)!=="$$"&&p!=="slot"&&console.warn(`<Page> was created with unknown prop '${p}'`)});function F(){n=this.value,t(0,n)}return a.$capture_state=()=>({ArtistSearchResult:Be,PlaylistResult:nt,TrackSearchResult:be,accessToken:pe,refreshToken:Oe,callWithRetry:te,onMount:Ae,slide:me,db:Ee,userData:Re,fbUser:Ie,Icon:xe,Navigation:et,spotifyUser:De,collection:we,doc:Me,getDocs:Ge,query:Qe,updateDoc:Fe,where:We,searchQuery:n,searchResults:i,topUserArtists:u,topUserTracks:f,user:b,userPlaylists:O,unfinishedTracks:T,authorizeSpotify:E,getSearch:A,getUnfinishedTracks:$,$fbUser:l,$accessToken:s,$userData:o}),a.$inject_state=p=>{"searchQuery"in p&&t(0,n=p.searchQuery),"searchResults"in p&&t(1,i=p.searchResults),"topUserArtists"in p&&t(2,u=p.topUserArtists),"topUserTracks"in p&&t(3,f=p.topUserTracks),"user"in p&&(b=p.user),"userPlaylists"in p&&t(4,O=p.userPlaylists),"unfinishedTracks"in p&&t(5,T=p.unfinishedTracks)},e&&"$$inject"in e&&a.$inject_state(e.$$inject),[n,i,u,f,O,T,s,o,E,A,F]}class It extends Je{constructor(e){super(e),Ke(this,e,mt,je,Le,{}),G("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:je.name})}}export{It as component};
